# PRD: わんこめネオンCSS調整

作成日: 2026-01-18
ステータス: Ready for Review（CSS分析完了）

---

## 1. 概要

### 1.1 目的
わんこめ（OneComme）のネオンテンプレートについて、以下を実現する：
- 背景に薄いグレー（#e0e0e0）を追加
- ネオン光彩効果の強度を弱める
- コメントテキストとユーザー名に適切なネオン効果を適用

### 1.2 背景・課題
- 現在のネオンテンプレートは視覚的に強すぎる可能性がある
- 背景が暗いまたは透明で、読みやすさに課題がある
- 光彩効果の調整により、より洗練された見た目を実現したい

### 1.3 スコープ

#### In（対象範囲）
- 既存ネオンCSSファイルの修正
- 背景色の追加（#e0e0e0）
- ネオン光彩強度の調整（弱める）
- コメントテキストへのネオン効果
- ユーザー名へのネオン効果

#### Out（対象外）
- 新規テンプレートの作成
- ネオンカラーの変更（色相・彩度の変更）
- アニメーション速度の変更
- レイアウト・配置の変更
- レスポンシブ対応の追加
- 枠線・背景へのネオン効果

---

## 2. ユーザー

### 2.1 ターゲットユーザー
- 配信者（ストリーマー）
- OBS/配信ソフトでコメント表示を使用するユーザー

### 2.2 ユーザーストーリー
- **配信者として**、視聴者のコメントを読みやすく表示したい。なぜなら、配信中にコメントを見逃さず、インタラクションを高めたいから。
- **配信者として**、ネオン効果を適度に抑えたい。なぜなら、派手すぎると配信画面が見づらくなるから。
- **配信者として**、背景に薄いグレーを入れたい。なぜなら、透明背景だと配信画面と重なって読みにくいから。

### 2.3 権限マトリクス
（該当なし - CSSのみの調整）

---

## 3. システム構成

### 3.1 サービス依存関係
（該当なし - 単一CSSファイルの修正）

### 3.2 データフロー
1. ユーザーがCSSファイルを配信ソフト（OBS等）に読み込み
2. わんこめアプリがコメントデータを表示
3. CSSスタイルが適用され、ネオン効果が表示される

### 3.3 外部API仕様
（該当なし）

---

## 4. 機能要件

### 4.1 CSS調整項目

#### 4.1.1 背景色の追加
| プロパティ | 値 | 適用先 | 備考 |
|-----------|---|--------|------|
| background-color | #e0e0e0 | コメントコンテナ | 薄いグレー、ネオンが映える明るさ |
| background | rgba(224, 224, 224, 0.95) | （代替案）半透明 | 配信画面が微かに透ける |

#### 4.1.2 ネオン光彩強度の調整

**現状（`--lcv-neon-shadow`）- 7層**:
```css
0 0 4px #fff,   /* 白ベース */
0 0 8px #fff,
0 0 12px #fff,
0 0 16px #0ff,  /* シアン */
0 0 20px #0ff,
0 0 24px #0ff,
0 0 28px #0ff
```

**調整後 - 3層（57%削減）**:
```css
0 0 3px #fff,   /* 白ベース: 4px → 3px */
0 0 6px #0ff,   /* シアン1: 8px → 6px */
0 0 9px #0ff    /* シアン2: 12px → 9px */
```

**削除レイヤー**: 16px, 20px, 24px, 28px（強すぎる外側の光彩）

**調整方針**:
- 多重シャドウの数を減らす（7層 → 3層、57%削減）
- 各レイヤーのぼかし半径を縮小（最大28px → 9px）
- ベースカラー（白）を1層のみに削減
- パフォーマンス向上: GPU負荷を大幅に軽減

#### 4.1.3 適用先要素（確定）

| 要素 | CSS変数 | 現状 | 調整後 | 備考 |
|------|---------|------|--------|------|
| コメントテキスト | `--lcv-comment-shadow` | `var(--lcv-comment-shadow-1)` | `var(--lcv-neon-shadow)` | ネオン効果適用 |
| ユーザー名 | `--lcv-name-shadow` | `var(--lcv-name-shadow-1)` | `var(--lcv-neon-shadow)` | ネオン効果適用 |
| コメント背景 | `--lcv-background-color` | `transparent` | `#e0e0e0` | グレー背景追加 |

**ネオン色**:
- `--neon-color`: `#0ff`（シアン）
- `--neon-base-color`: `#fff`（白）

**セレクタ**:
- `.comment`: コメント要素全体（背景色が適用される）

---

### 4.2 状態・振る舞い

#### 4.2.1 静的スタイル
- 背景色は常に #e0e0e0
- ネオン効果は常時適用（点滅なし）

#### 4.2.2 アニメーション（変更なし）
- 既存のアニメーション（点滅、フェード等）は維持
- 速度・タイミングは変更しない

---

## 5. 非機能要件

### 5.1 パフォーマンス
- **ブラウザレンダリング**: text-shadow の多用は重いため、2層程度に抑える
- **目標**: 60fps を維持（OBS Browser Source での表示）
- **制約**: レイヤーを減らすことでGPU負荷を軽減

### 5.2 ブラウザ互換性
- OBS Browser Source（Chromiumベース）での動作が必須
- モダンブラウザ（Chrome, Firefox, Edge）での動作確認

### 5.3 可読性
- **コントラスト比**: WCAG 2.1 AA基準（4.5:1以上）を目指す
- **背景 #e0e0e0** と **ネオン色** の組み合わせで十分なコントラストを確保

### 5.4 保守性
- CSSコメントで調整箇所を明記
- 変数（CSS Custom Properties）を使用して、色・強度の調整を容易にする

---

## 6. 受け入れ基準

- [ ] 背景色が #e0e0e0 で表示される
- [ ] コメントテキストにネオン効果が適用される
- [ ] ユーザー名にネオン効果が適用される
- [ ] ネオン光彩が元より弱く（控えめに）表示される
- [ ] 枠線・背景にはネオン効果が適用されない
- [ ] OBS Browser Source で正常に表示される
- [ ] 既存のアニメーションが維持される
- [ ] テキストが読みやすい（コントラスト十分）

---

## 7. 技術的実装案

### 7.1 CSS調整の方針

**採用方針**: 既存のCSS変数システムを活用（既にCSS変数が使われている）

#### 調整箇所（3箇所）

**1. ネオンシャドウの弱体化**
```css
/* 変更前（7層） */
--lcv-neon-shadow:
    0 0 4px var(--neon-base-color),
    0 0 8px var(--neon-base-color),
    0 0 12px var(--neon-base-color),
    0 0 16px var(--neon-color),
    0 0 20px var(--neon-color),
    0 0 24px var(--neon-color),
    0 0 28px var(--neon-color);

/* 変更後（3層） */
--lcv-neon-shadow:
    0 0 3px var(--neon-base-color),
    0 0 6px var(--neon-color),
    0 0 9px var(--neon-color);
```

**2. ボックスシャドウの弱体化**
```css
/* 変更前（3層） */
--lcv-neon-box-shadow:
    drop-shadow(0 0 2px var(--neon-base-color))
    drop-shadow(0 0 4px var(--neon-base-color))
    drop-shadow(0 0 6px var(--neon-color));

/* 変更後（2層） */
--lcv-neon-box-shadow:
    drop-shadow(0 0 2px var(--neon-base-color))
    drop-shadow(0 0 4px var(--neon-color));
```

**3. 背景色の追加**
```css
/* 変更前 */
--lcv-background-color: transparent;

/* 変更後 */
--lcv-background-color: #e0e0e0;
```

#### 実装ファイル

- `original_neon.css`: オリジナル版（バックアップ）
- `adjusted_neon.css`: 調整版（推奨）

---

## 8. 次のステップ

### 8.1 CSS受領待ち
- ユーザーから既存CSSファイルを受領
- セレクタ、プロパティ値を確認
- 具体的な調整箇所を特定

### 8.2 PRD完成後
- [ ] `/plan` で実装計画を策定
- [ ] `/dev` で実装開始（CSSファイル編集）
- [ ] ビフォー・アフターのプレビュー作成（HTML サンプル）
- [ ] OBSでの動作確認

---

## 9. CSS分析結果

### 9.1 確認済み項目
- ✅ CSSセレクタ構造: `.comment` クラス、CSS変数システム
- ✅ 現在のネオン強度: 7層（4px〜28px）
- ✅ アニメーション: `--lcv-enter-duration`, `--lcv-move-duration` で制御（調整対象外）
- ✅ 色の種類: シアン（#0ff）+ 白ベース（#fff）

### 9.2 その他の発見事項

**未使用の可能性がある変数**:
- `--lcv-name-shadow-1〜5`: 詳細な多重シャドウ定義が存在
- `--lcv-comment-shadow-1〜5`: 同上
- これらは現在 `--lcv-name-shadow-0`（none）が適用されているため未使用

**調整の影響範囲**:
- ネオンシャドウ: `--lcv-neon-shadow` を参照する全要素に適用
- 背景色: `.comment` 要素に適用

---

## 付録: 参考情報

### A. ネオン効果のBefore/After比較

**Before（オリジナル - 7層）**:
```css
--lcv-neon-shadow:
    0 0 4px #fff,
    0 0 8px #fff,
    0 0 12px #fff,
    0 0 16px #0ff,
    0 0 20px #0ff,
    0 0 24px #0ff,
    0 0 28px #0ff;
```
- レイヤー数: 7層
- 最大ぼかし: 28px
- GPU負荷: 高

**After（調整版 - 3層）**:
```css
--lcv-neon-shadow:
    0 0 3px #fff,
    0 0 6px #0ff,
    0 0 9px #0ff;
```
- レイヤー数: 3層（57%削減）
- 最大ぼかし: 9px（68%削減）
- GPU負荷: 軽減

**視覚的効果**:
- オリジナル: 強烈な光彩、外側まで広がる
- 調整版: 控えめな光彩、テキストに近い範囲のみ

### B. 背景色の候補
| 色コード | 説明 | 備考 |
|---------|------|------|
| #e0e0e0 | 薄いグレー（選択済み） | 推奨 |
| #f0f0f0 | より薄いグレー | 代替案1 |
| rgba(224, 224, 224, 0.9) | 半透明グレー | 代替案2 |

---

---

## 10. ファイル一覧

| ファイル名 | 説明 | 状態 |
|-----------|------|------|
| `PRD_neon_css_adjustment.md` | 本PRD | ✅ 完成 |
| `original_neon.css` | オリジナル版（バックアップ） | ✅ 作成済み |
| `adjusted_neon.css` | 調整版（推奨使用） | ✅ 作成済み |
| `preview.html` | ビフォー・アフター比較プレビュー | 🔜 作成予定 |

---

## 次のアクション

**PRDレビューを実施します。承認後、以下から選択してください:**

1. ✅ **PRDを承認** → プレビューHTML作成
2. 📝 **PRD修正** → 指摘事項を反映
3. 🚀 **実装開始** → `/dev` でCSSファイル配布準備
